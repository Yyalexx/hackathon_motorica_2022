# Описание задачи 3 этапа

## Текущая постановка задачи:

- собраны данные от 3х разных "пилотов" (2 из которых пришли на экскурсию от Скиллфактори в офис Моторики), для участников размечено, какие данные относятся к какому пилоту;
- вместо обучающей выборки из наблюдений участникам предоставляется непрерывный массив OMG-данных и соответствующий массив с целевой переменной;  
- в OMG-данных есть участки с потенциально "битыми" данными, поэтому в целевой переменной появляется специальный класс -1, обозначающий потенциально "битые" данные;
- количество уникальных жестов уменьшено, набор уникальных жестов следующий:
1 - потенциально "битые" данные;
0 - команда "жест open";
1 - команда "жест пистолет";
2 - команда "сгиб большого пальца";
3 - команда "жест ОК";
4 - команда "жест grab";

- наблюдения в тестовых OMG-данных из себя представляют временные отрезки переменной длины, внутри которых могут совершаться жесты (один и больше), а могут и не совершаться жесты вообще;
- каждое наблюдение в тестовых OMG-данных начинается с "жеста open";
- жесты в тестовых OMG-данных могут иметь разную скорость совершения от наблюдения к наблюдению, но единую скорость внутри одного наблюдения.
## Описание проделанной работы
Была произведена очиста данных:

при рассмотрении амплитуды сигналов датчиков для каждого пилота был произведен ортбор активных датчиков, амплитуда сигнала которых превышает определенный порог, который был выбран на основании графиков амплитуды. Порог tres = 200
сформирован список датчиков, являющихся активными для всех пилотов
Была сделана предварительная обработка массива входных данных:

поскольку в обучающих выборках содержится по 33-34 команды каждого жеста, для увеличения количества обучающих выборок было принято решение выделить каждый жест, разбить его на несколько окон frames, сопоставив каждому окну значение целевой переменной.
в результате экспериментов были определены оптимальные значения количества окон разбиения жеста n_frames и тиков в каждом окне n_ticks. Для компенсации задержки начала жеста относительно команды произведен сдвиг на величину shift_gest_beg.
Были удалены участки, помеченные в целевой переменной Bad data, а также соответствующие им данные.

Для отслеживания отсутствия переобучения была проведена кросс-валидация.

Модель была обучена с помощью нейронной сети Keras. После обучения модели была сделана постобработка для сглаживания неоднозначности определения выполненной пользователем команды. Тренировка модели проходит в несколько этапов:

Обучение 100 эпох с learning_rate=1e-2. Дообучение модели 2 раза по 10 эпох с learning_rate=1e-3.

Для обучения модели на новых данных был написан скрипт predict_moving_fr.py. На вход подается массив X форматом (50, N) (датчики, таймстепы) в файле pkl. Данный скрипт делает предсказание на основе 3 моделей из файлов m1_best.h5, m2_best.h5, m3_best.h5.

Выводы
Наибольший score - 0.68138.

Для распознавания команд, которые выполнялись пользователем, были применены модели машинного обучения, которые решали задачу классификации.

Основной задачей стало правильная разметка целевой переменной. Также наилучшей метрики позволила достичь постобработка submission с помощью mode.

Данная модель обеспечивают достаточно хорошую классификацию команд пользователей.